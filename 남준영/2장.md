# 지역 상태와 전역 상태 사용하기

## 2장 지역 상태와 전역 상태 사용하기

---

트리의 상위 컴포넌트에서 지역 상태를 만들고 컴포넌트와 자식 컴포넌트에서 해당 상태를 사용하면 지역성과 재사용성 측면에서 좋지만 멀리 떨어져 있는 컴포넌트간 공통적인 상태가 필요한 경우 전역 상태가 필요하다.

### 언제 지역 상태를 사용할까?

같은 인수에 대 항상 같은 값을 반환하는 순수 함수는 동작을 예측할 수 있어서 선호 된다.

```jsx
let base = 1;

// addBase는 외부 변수 base에 의존된다.
const addBase = (n) => n + base;
```

base가 싱글턴(자바스크립트의 전역 변수는 window 객체에 등록되어 사용된 싱글턴이다.)으로 사용되면 재사용성이 떨어지기 떄문에 컨테이너 객체를 만들어서 모듈화 하면 된다. 서로 영향을 끼치지 않는다.

```jsx
const creatContainer = () => {
  let base = 1;
  const addBase = (n) => n + base;
  return { addBase };
};

const { addBase } = createContainer();
```

아래 AddBase에서 useState로 사용중인 base는 changeBase를 함수 선언 범위 내에서만 사용할 수 있기 때문에 억제되었다고 표현하며 지역성을 보장한다. 함수 컴포넌트 외부에서 상태를 변경하고 싶다면 전역 상태를 사용해야 된다. 전역 상태는 컴포넌트 동작을 예측하기 어렵게 하기 때문에 사용을 자제하는것이 좋다.

```jsx
const AddBase = ({ number }) = > {
	const [base, changeBase] = useState(1);
	return <div>{number + base}</div>
}
```

### 지역 상태를 효과적으로 사용하는 방법

1. 상태 끌어올리기 (Lifting State Up) -부모 컴포넌트 트리에서 상태를 정의
   -props로 전달한 상태는 하위 트리 전체를 리렌더링 하기 때문에 성능에 안좋다.

2. 내용 끌어올리기 (Lifting Content Up)

- 부모 컴포넌트 트리에서 내용을 정의
- 변경되지 않는 요소를 { children }으로 사용해서 의미없는 리렌더링을 막을 수 있다.

```jsx
const GrandParent = () => {
	return (
		<Parent>
			<AdditionInfo /> // children
		</Parent>
	)
}

const Parent = ({ children }) => {
	...
}
```

### 전역 상태란?

하나의 컴포넌트에 속하고 컴포넌트에 의해 캡슐화된 상태가 지역 상태라면 전역 상태는 하나의 컴포넌트에 속하지 않고 여러 컴포넌트에서 사용될 수 있다.

전역 변수는 크게 props으로 전달하기 적절하지 않을 때 (너무 깊어서), 이미 리엑트 외부에 상태가 있을 때 사용된다.
